\documentclass[12pt,draftclsnofoot,journal,onecolumn]{IEEEtran}
\usepackage{amsfonts}
\usepackage{amsmath,amssymb}
\usepackage{acronym}  % make an acronym
\usepackage{algorithm,algorithmic}
\usepackage{balance}
\usepackage{bm}
\usepackage{booktabs}
\usepackage{color, soul}
\usepackage{cite}
\usepackage{flushend}
\usepackage{graphicx}
\usepackage{indentfirst}
\usepackage{tikz}
\usetikzlibrary{arrows}
\usepackage{subfigure}
\usepackage[amsmath,thmmarks]{ntheorem}
\usepackage{theorem}
% Enable Hyper-references.
\usepackage{hyperref}
\hypersetup{hidelinks, 
colorlinks=true,
allcolors=black,
pdfstartview=Fit,
breaklinks=true}

\newtheorem{theorem}{\bf Theorem}
\newtheorem{proposition}{\bf Proposition}
\newtheorem{lemma}{\bf Lemma}
\newtheorem{definition}{Definition}
\newtheorem{remark}{\bf Remark}

\theoremheaderfont{~~~\it}\theorembodyfont{\upshape}%
\theoremstyle{nonumberplain}
\theoremseparator{}
\theoremsymbol{\rule{1ex}{1ex}}
\newtheorem{proof}{Proof:}
\acrodef{EAR}[EAR]{element activation ratio}
\acrodef{SNR}[SNR]{signal-to-noise ratio}
\acrodef{TC}[TC]{transmission coefficients}
\acrodef{US-RIS}[US-RIS]{user-side RIS}
\acrodef{BSS-RIS}[BSS-RIS]{base-station-side RIS}
\acrodef{DoF}[DoF]{degree of freedom}
\acrodef{FPGA}[FPGA]{field programmable gate array}
\acrodef{RF}[RF]{radio-frequency}
\acrodef{RIS}[RIS]{reconfigurable intelligent surfaces}
\acrodef{UE}[UE]{user equipment}
\acrodef{DL}[DL]{downlink}
\acrodef{TA}[TA]{transmit antenna}
\acrodef{RA}[RA]{receive antenna}
\acrodef{LoS}[LoS]{line-of-sight}
\acrodef{UL-TBF}[UL-TBF]{uplink transmit beamforming}
\acrodef{TPS}[TPS]{transmit phase shifter}
\acrodef{RC}[RC]{receiver combining}
\acrodef{AWGN}[AWGN]{additive white Gaussian noise}

\def \H {^H}
\def \opt {^{\text{opt}}}
\def \v {\bm v}
\def \w {\bm w}
\def \g {\bm g}
\def \f {\bm f}
\def \T {\bm \Theta}
\def \t {\bm \theta}
\def \x {\bm \xi}
\def \Pmax {P_{\text{max}}}
\def \ml {multi-layer }
\def \tb {transmit beamformer }
\def \sl {single-layer }
\def \diag {\text{diag}}
\def \opt {^{\text{opt}}}
\def \exp {\text{exp}}
\def \arg {\text{arg}}
\newcommand{\RNum}[1]{\uppercase\expandafter{\romannumeral #1\relax}}
\renewcommand{\algorithmicrequire}{\textbf{Input:}}   %Use Input in the format of Algorithm
\renewcommand{\algorithmicensure}{\textbf{Output:}}  %UseOutput in the format of Algorithm
\ifCLASSINFOpdf
\else
\fi
\hyphenation{op-tical net-works semi-conduc-tor}
\begin{document}
\title{Sensing RIS}
\author{{Authors
\vspace*{-1em}}
\thanks{Beijing National Research Center for Information Science and Technology (BNRist)}
%\thanks{Corresponding author: Linglong Dai.}
}

\maketitle

\begin{abstract}
xxx
\end{abstract}

\begin{IEEEkeywords}
xxx
\end{IEEEkeywords}
\section{Introduction}
    Sensing RIS \cite{ma2020smartsensing}.
\section{System Model}
\label{System Model}
\subsection{MISO case}
\label{MISO case}

RIS phase-shift matrix:
\begin{equation}
\label{RIS}
\bm \Theta = \diag \left(\bm \theta\right )=\diag \left(\left[\theta_{1},\cdots ,\theta_{N}\right]\right).
\end{equation}

Signal model:
\begin{equation}
\label{Signal model}
y=\bm f^{H}\bm \Theta\bm G\bm ws+z,
\end{equation}
where $\bm f\in \mathbb C ^{N\times 1}$ and $\bm G \in \mathbb C^{N\times M}$ denote the channel spanning from the RIS to the user and the channel spanning from the BS to the RIS, respectively; $\bm w\in \mathbb C^{M\times 1}$ denotes the beamforming vector at the transmitter BS, with $\left\Vert \bm w\right \Vert_{2}^{2}\leq P$; $s$ denotes the transmitted normalized symbol; $z\sim \mathcal{CN}\left(0,\sigma_{z}^{2}\right)$ denotes the \ac{AWGN} introduced at the receiver user.

With fixed positions of the BS and the RIS, the beamforming vector can be fixed as
\begin{equation}
\label{fixed w}
\bm w=\sqrt{P}\bm a\left(\alpha\right),
\end{equation}
where $\alpha$ is ...

The SNR maximization problem for the receiver user can be formulated as
\begin{subequations}
\label{optimization}
\begin{align}
\label{objective}
\max_{\bm \Theta}~~&\text{SNR}=\frac{1}{\sigma_{z}^{2}}
\left\vert
\bm f^{H}\bm \Theta\bm G\bm w \right\vert^{2},\\
\label{constraint}
~~~~~\text{s.t.~~~}&\left\vert\theta_{n}\right\vert=1,~\forall n.
\end{align}
\end{subequations}

The optimal phase-shift for the $n$-th RIS element can be obtained as
\begin{equation}
\label{optimal RIS}
\theta_{n}\opt = \exp\left(-j\arg\left(f_{n}^{*}\bm g_{n}^{T}\bm w\right)\right),~\forall n,
\end{equation}
where $\bm G = \left[\bm g_{1}, \cdots, \bm g_{N}\right]^{T}$.

Interference field at the $n$-th RIS element, with transmitted symbol $s=1$:
\begin{equation}
\label{interference}
E_{n}(t)=\bm g_{n}^{T}\bm w+f_{n}^{*}e^{j\psi (t)}+v(t).
\end{equation}

Define $\alpha = \left\vert\bm g_{n}^{T}\bm w\right\vert$ and $\beta = \left\vert f_{n}^{*}\right \vert$, and define the phase to be measured as $\varphi = \arg\left(f_{n}^{*}\right)-\arg\left(\bm g_{n}^{T}\bm w\right)$.
Then, the power of interference field can be written as
\begin{equation}
\label{Power of Interference}
\begin{aligned}
P(t)&=A \left| E_{n} (t)\right |^{2}+\zeta\\
&=\underbrace{A\left[\alpha^{2}+\beta^{2}+2\alpha\beta\cos\left(\psi(t)+\varphi\right)\right]}_{\text{Sensor detection signal}}\\
&~~~+\underbrace{2A\text{Re}\left\{\left(\alpha+\beta e^{j\left(\psi(t)+\varphi\right)}\right)v^{*}(t)\right\}+A\left|v(t)\right|^{2}+\zeta}_{\text{Noise}}.
\end{aligned}
\end{equation}
To estimate the phase $\varphi$, we need enough observations from the sensor detection signal. For simplicity and without loss of generality, let us assume $\psi(t)=\omega t$. Assume furthermore that $L$ observations $P(t_{1}),\cdots ,P(t_{L})$ at time $t_{1},\cdots ,t_{L}$ are used for estimation.
\subsubsection{LS method}


%% zja working below
\subsubsection{ML method}
    Suppose the noise field $v'(t)=v_R(t) + jv_I(t)\sim \mathcal{CN}(0, \sigma_v^2)$, and the noise of the power sensor is $\zeta \sim \mathcal{N}(0, \sigma_{\zeta}^2)$. Then the distribution of $A\left|E_n(t)\right|^2$ is a noncentral chi-squared distribution of $k=2$ and 
    \begin{equation}
        \begin{aligned}
        g_n & = \sum\nolimits_{m=1}^{M}G_{nm}u_{m}  \\
        \lambda & = 
        \end{aligned}
    \end{equation} 

\appendices


\section*{Acknowledgments}


\footnotesize
\balance 
\bibliographystyle{IEEEtran}
\bibliography{SensingRIS, IEEEabrv}

\end{document}











